[global]
host = 192.168.1.145
user = sa
pass = Addj@123
driver = ODBC Driver 17 for SQL Server
import = \\192.168.1.25\PULL
tmp = \\192.168.1.25\PUSH
excel = \\192.168.1.25\SFTP\Xuat excel import
tk = \\192.168.1.25\SFTP\Thống kê
txt = \\192.168.1.98\d\
tkks = SELECT so, quyenSo, trangSo, ngayDangKy, TenLoaiDangKy, TenNoiDangKy, nksHoTen, TenGioiTinh,  nksNgaySinh, dt.TenDanToc, qt.TenQuocTich, meHoTen, meNgaySinh, dtm.TenDanToc as 'meDanToc',  qtm.TenQuocTich as 'meQuocTich',   lctm.TenLoaiCuTru as 'meLoaiCuTru', chaHoTen, chaNgaySinh,   dtc.TenDanToc as 'chaDanToc', qtc.TenQuocTich as 'chaQuocTich', lctc.TenLoaiCuTru as 'chaLoaiCuTru',   GhiChu, nksNoiSinh, meNoiCuTru, chaNoiCuTru, nycHoTen, nycQuanHe, nguoiKy, chucVuNguoiKy,   NguoiThucHien, lks.TenLoaiKhaiSinh, nsdvhc.ten, nksQueQuan, lgtnk.TenLoaiGiayTo,   nycSoGiayToTuyThan, nycNgayCapGiayToTuyThan, nycNoiCapGiayToTuyThan, nksNgaySinhBangChu   FROM HT_KHAISINH ks left join  HT_KS_LOAIDANGKY ldk on ks.loaiDangKy = ldk.MaLoaiDangKy   left join  DM_GIOITINH gt on  ks.nksGioiTinh = gt.MaGioiTinh left join  DM_DANTOC dt on ks.nksDanToc = dt.MaDanToc   left join  DM_DANTOC dtm on ks.meDanToc = dtm.MaDanToc left join  DM_DANTOC dtc on ks.chaDanToc = dtc.MaDanToc   left join  DM_QUOCTICH qt on ks.nksQuocTich = qt.MaQuocTich left join  DM_QUOCTICH qtm on ks.meQuocTich = qtm.MaQuocTich   left join  DM_QUOCTICH qtc on ks.chaQuocTich = qtc.MaQuocTich left join  HT_NOIDANGKY ndk on ks.noiDangKy = ndk.MaNoiDangKy   left join  DM_LOAICUTRU lctm on ks.meLoaiCuTru = lctm.MaLoaiCuTru left join  DM_LOAICUTRU lctc on ks.chaLoaiCuTru = lctc.MaLoaiCuTru   left join  HT_KS_LOAIKHAISINH lks on ks.nksLoaiKhaiSinh = lks.MaLoaiKhaiSinh   left join  HT_LOAIGIAYTO lgtnk on ks.nycLoaiGiayToTuyThan = lgtnk.MaLoaiGiayTo   left join  HT_Tinh_NoiSinh nsdvhc on ks.nksNoiSinhDVHC = nsdvhc.Ma   
tkkt = SELECT So, quyenSo, trangSo, ngayDangKy, TenLoaiDangKy, TenNoiDangKy, nktHoTen,  TenGioiTinh, nktNgaySinh,  dt.TenDanToc, qt.TenQuocTich, TenLoaiCuTru, lgt.TenLoaiGiayTo as 'nktLoaiGiayTo',    nktSoGiayToTuyThan, nktNgayChet, GhiChu, nktGioPhutChet, nktNoiChet, nktNguyenNhanChet,    nktNoiCuTru, nycHoTen, nycQuanHe, nguoiKy, chucVuNguoiKy, nguoiThucHien,  nktNgayCapGiayToTuyThan,   nktNoiCapGiayToTuyThan, gbt.TenLoai, gbtSo, gbtNgay,  gbtCoQuanCap, lgtnk.TenLoaiGiayTo,   nycSoGiayToTuyThan, nycNgayCapGiayToTuyThan, nycNoiCapGiayToTuyThan   FROM HT_KHAITU kt  left join HT_KT_LOAIDANGKY ldk on kt.loaiDangKy = ldk.MaLoaiDangKy   left join HT_NOIDANGKY ndk on kt.noiDangKy = ndk.MaNoiDangKy left join DM_GIOITINH gt on kt.nktGioiTinh = gt.MaGioiTinh   left join DM_DANTOC dt on kt.nktDanToc = dt.MaDanToc left join DM_QUOCTICH qt on kt.nktQuocTich = qt.MaQuocTich   left join DM_LOAICUTRU lct on kt.nktLoaiCuTru = lct.MaLoaiCuTru left join HT_LOAIGIAYTO lgt on kt.nktLoaiGiayToTuyThan = lgt.MaLoaiGiayTo   left join HT_KT_LOAI_GIAY_BAO_TU gbt on kt.gbtLoai = gbt.MaLoai left join HT_LOAIGIAYTO lgtnk on kt.nktLoaiGiayToTuyThan = lgtnk.MaLoaiGiayTo   
tkkh = SELECT So, quyenSo, trangSo, ngayDangKy, TenLoaiDangKy, TenNoiDangKy, chongHoTen,  chongNgaySinh,  dtc.TenDanToc as 'chongDanToc', qtc.TenQuocTich as 'chongQuocTich', lctc.TenLoaiCuTru as 'chongLoaiCuTru', lgtc.TenLoaiGiayTo as 'chongLoaiGiayTo',    chongSoGiayToTuyThan, voHoTen, voNgaySinh, dtv.TenDanToc as 'voDanToc',   qtv.TenQuocTich as 'voQuocTich', lctv.TenLoaiCuTru as 'voLoaiCuTru',  lgtv.TenLoaiGiayTo as 'voLoaiGiayTo', voSoGiayToTuyThan, GhiChu, chongNoiCuTru, voNoiCuTru, nguoiKy,  chucVuNguoiKy, nguoiThucHien, chongNgayCapGiayToTuyThan, chongNoiCapGiayToTuyThan,  voNgayCapGiayToTuyThan, voNoiCapGiayToTuyThan FROM HT_KETHON kh left join HT_KH_LOAIDANGKY ldk on kh.loaiDangKy = ldk.MaLoaiDangKy left join HT_NOIDANGKY ndk on kh.noiDangKy = ndk.MaNoiDangKy left join DM_DANTOC dtc on kh.chongDanToc = dtc.MaDanToc left join DM_QUOCTICH qtc on kh.chongQuocTich = qtc.MaQuocTich left join DM_LOAICUTRU lctc on kh.chongLoaiCuTru = lctc.MaLoaiCuTru left join HT_LOAIGIAYTO lgtc on kh.chongLoaiGiayToTuyThan = lgtc.MaLoaiGiayTo left join DM_DANTOC dtv on kh.voDanToc = dtv.MaDanToc left join DM_QUOCTICH qtv on kh.voQuocTich = qtv.MaQuocTich left join DM_LOAICUTRU lctv on kh.voLoaiCuTru = lctv.MaLoaiCuTru left join HT_LOAIGIAYTO lgtv on kh.voLoaiGiayToTuyThan = lgtv.MaLoaiGiayTo   
tkcmc = SELECT So, quyenSo, trangSo, quyetDinhSo, ngayDangKy, TenLoaiDangKy, TenLoaiXacNhan,  TenNoiDangKy, cmHoTen, cmNgaySinh,  dtcm.TenDanToc as 'cmDanToc', qtcm.TenQuocTich as 'cmQuocTich', lctcm.TenLoaiCuTru as 'cmLoaiCuTru' , lgtcm.TenLoaiGiayTo as 'cmLoaiGiayTo',    cmSoGiayToTuyThan, ncHoTen, ncNgaySinh, dtnc.TenDanToc, qtnc.TenQuocTich, lctnc.TenLoaiCuTru, lgtnc.TenLoaiGiayTo as 'ncLoaiGiayTo',  ncSoGiayToTuyThan, GhiChu, cmNoiCuTru, ncNoiCuTru, nycHoTen, nycQHNguoiDuocNhan,  nguoiKy, chucVuNguoiKy, nguoiThucHien, cmQueQuan, cmNgayCapGiayToTuyThan,  cmNoiCapGiayToTuyThan, ncQueQuan, ncNgayCapGiayToTuyThan, ncNoiCapGiayToTuyThan,  lgtnk.TenLoaiGiayTo, nycSoGiayToTuyThan, nycNgayCapGiayToTuyThan, nycNoiCapGiayToTuyThan FROM HT_NHANCHAMECON cmc left join HT_NCM_LOAIDANGKY ldk on cmc.loaiDangKy = ldk.MaLoaiDangKy left join DM_LOAIXACNHAN lxn on cmc.loaiXacNhan = lxn.MaLoaiXacNhan left join HT_NOIDANGKY ndk on cmc.noiDangKy = ndk.MaNoiDangKy left join DM_DANTOC dtcm on cmc.cmDanToc = dtcm.MaDanToc left join DM_QUOCTICH qtcm on cmc.cmQuocTich = qtcm.MaQuocTich left join DM_LOAICUTRU lctcm on cmc.cmLoaiCuTru = lctcm.MaLoaiCuTru left join HT_LOAIGIAYTO lgtcm on cmc.cmLoaiGiayToTuyThan = lgtcm.MaLoaiGiayTo left join DM_DANTOC dtnc on cmc.ncDanToc = dtnc.MaDanToc left join DM_QUOCTICH qtnc on cmc.ncQuocTich = qtnc.MaQuocTich left join DM_LOAICUTRU lctnc on cmc.ncLoaiCuTru = lctnc.MaLoaiCuTru left join HT_LOAIGIAYTO lgtnc on cmc.ncLoaiGiayToTuyThan = lgtnc.MaLoaiGiayTo left join HT_LOAIGIAYTO lgtnk on cmc.nycLoaiGiayToTuyThan = lgtnk.MaLoaiGiayTo   
tkhn = SELECT So, quyenSo,  trangSo,  ngayDangKy,  TenNoiDangKy,  nguoiKy,  chucVuNguoiKy,  nguoiThucHien,  ghiChu,  nxnHoTen,  TenGioiTinh,  nxnNgaySinh,  TenDanToc,  TenQuocTich,  nxnQuocTichKhac,  TenLoaiCuTru,  nxnNoiCuTru,  lgtnxn.TenLoaiGiayTo as 'nxnGiayTo',  nxnGiayToKhac,  nxnSoGiayToTuyThan,  nxnNgayCapGiayToTuyThan,  nxnNoiCapGiayToTuyThan,  nxnThoiGianCuTruTai,  nxnThoiGianCuTruTu,  nxnThoiGianCuTruDen,  nxnTinhTrangHonNhan,  nxnLoaiMucDichSuDung,  TenMucDich,  nycHoTen,  nycQuanHe,  lgtnyc.TenLoaiGiayTo as 'nycGiayTo',  nycGiayToKhac,  nycSoGiayToTuyThan,  nycNgayCapGiayToKhac,  nycNoiCapGiayToKhac  FROM HT_XACNHANHONNHAN ks   left join  DM_GIOITINH gt on  ks.nxnGioiTinh = gt.MaGioiTinh   left join  DM_DANTOC dt on ks.nxnDanToc = dt.MaDanToc    left join  DM_QUOCTICH qt on ks.nxnQuocTich = qt.MaQuocTich   left join  HT_NOIDANGKY ndk on ks.noiCap = ndk.MaNoiDangKy   left join  DM_LOAICUTRU lctm on ks.nxnLoaiCuTru = lctm.MaLoaiCuTru   left join  HT_LOAIGIAYTO lgtnxn on ks.nxnLoaiGiayToTuyThan = lgtnxn.MaLoaiGiayTo   left join  HT_LOAIGIAYTO lgtnyc on ks.nycLoaiGiayToTuyThan = lgtnyc.MaLoaiGiayTo   left join  HT_HN_MUCDICH md on ks.nxnLoaiMucDichSuDung = md.MaMucDich   
ksfmt = SELECT SO, QUYENSO, NOIDANGKY, TENNOIDANGKY, ngayDangKy, nksHoTen, chaNgaySinh, meNgaySinh, nksNgaySinh, nycNgayCapGiayToTuyThan FROM HT_KHAISINH KS JOIN HT_NOIDANGKY NDK ON KS.NOIDANGKY = NDK.MANOIDANGKY  WHERE (SO=''   OR CHARINDEX('/',SO,0)=0  OR CHARINDEX('/',QUYENSO,0)=0   OR  ( trim(NGAYDANGKY) not like '[0-9][0-9].[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(NGAYDANGKY) not like '[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(NGAYDANGKY) is not null and trim(NGAYDANGKY) != '') or (CHARINDEX('T',trim(chaNgaySinh),0)=0 and trim(chaNgaySinh) not like '[0-9][0-9]' and trim(chaNgaySinh) not like '[0-9][0-9][0-9][0-9]' and trim(chaNgaySinh) not like '[0-9][0-9].[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(chaNgaySinh) not like '[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(chaNgaySinh) is not null and trim(chaNgaySinh) != '') or (CHARINDEX('T',trim(meNgaySinh),0)=0 and trim(meNgaySinh) not like '[0-9][0-9]' and trim(meNgaySinh) not like '[0-9][0-9][0-9][0-9]' and trim(meNgaySinh) not like '[0-9][0-9].[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(meNgaySinh) not like '[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(meNgaySinh) is not null and trim(meNgaySinh) != '') or (CHARINDEX('T',trim(nksNgaySinh),0)=0 and trim(nksNgaySinh) not like '[0-9][0-9]' and trim(nksNgaySinh) not like '[0-9][0-9][0-9][0-9]' and trim(nksNgaySinh) not like '[0-9][0-9].[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(nksNgaySinh) not like '[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(nksNgaySinh) is not null and trim(nksNgaySinh) != '') or (CHARINDEX('T',trim(nycNgayCapGiayToTuyThan),0)=0 and trim(nycNgayCapGiayToTuyThan) not like '[0-9][0-9]' and trim(nycNgayCapGiayToTuyThan) not like '[0-9][0-9][0-9][0-9]' and trim(nycNgayCapGiayToTuyThan) not like '[0-9][0-9].[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(nycNgayCapGiayToTuyThan) not like '[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(nycNgayCapGiayToTuyThan) is not null and trim(nycNgayCapGiayToTuyThan) != '')  )  
ktfmt = select so, quyenSo,noiDangKy, TenNoiDangKy, nktHoTen, ngayDangKy, gbtNgay, nktNgayCapGiayToTuyThan, nktNgayChet, nktNgaySinh, nycNgayCapGiayToTuyThan  from HT_KHAITU kt join HT_NOIDANGKY ndk on kt.noiDangKy = ndk.MaNoiDangKy  where (so=''  or  ngaydangky=''   or charindex('/',so,0)=0  or charindex('/',quyenSo,0)=0  or charindex('.',ngayDangKy,0)=0   OR  ( trim(NGAYDANGKY) not like '[0-9][0-9].[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(NGAYDANGKY) not like '[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(NGAYDANGKY) is not null and trim(NGAYDANGKY) != '') or (CHARINDEX('T',trim(gbtNgay),0)=0 and trim(gbtNgay) not like '[0-9][0-9]' and trim(gbtNgay) not like '[0-9][0-9][0-9][0-9]' and trim(gbtNgay) not like '[0-9][0-9].[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(gbtNgay) not like '[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(gbtNgay) is not null and trim(gbtNgay) != '') or (CHARINDEX('T',trim(nktNgayCapGiayToTuyThan),0)=0 and trim(nktNgayCapGiayToTuyThan) not like '[0-9][0-9]' and trim(nktNgayCapGiayToTuyThan) not like '[0-9][0-9][0-9][0-9]' and trim(nktNgayCapGiayToTuyThan) not like '[0-9][0-9].[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(nktNgayCapGiayToTuyThan) not like '[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(nktNgayCapGiayToTuyThan) is not null and trim(nktNgayCapGiayToTuyThan) != '') or (CHARINDEX('T',trim(nktNgayChet),0)=0 and trim(nktNgayChet) not like '[0-9][0-9]' and trim(nktNgayChet) not like '[0-9][0-9][0-9][0-9]' and trim(nktNgayChet) not like '[0-9][0-9].[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(nktNgayChet) not like '[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(nktNgayChet) is not null and trim(nktNgayChet) != '') or (CHARINDEX('T',trim(nktNgaySinh),0)=0 and trim(nktNgaySinh) not like '[0-9][0-9]' and trim(nktNgaySinh) not like '[0-9][0-9][0-9][0-9]' and trim(nktNgaySinh) not like '[0-9][0-9].[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(nktNgaySinh) not like '[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(nktNgaySinh) is not null and trim(nktNgaySinh) != '') or (CHARINDEX('T',trim(nycNgayCapGiayToTuyThan),0)=0 and trim(nycNgayCapGiayToTuyThan) not like '[0-9][0-9]' and trim(nycNgayCapGiayToTuyThan) not like '[0-9][0-9][0-9][0-9]' and trim(nycNgayCapGiayToTuyThan) not like '[0-9][0-9].[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(nycNgayCapGiayToTuyThan) not like '[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(nycNgayCapGiayToTuyThan) is not null and trim(nycNgayCapGiayToTuyThan) != '') ) 
khfmt = select so, quyenSo, ngayDangKy, TenNoiDangKy, voHoTen, chongHoTen, chongNgayCapGiayToTuyThan, chongNgaySinh, voNgayCapGiayToTuyThan, voNgaySinh   from HT_KETHON kh join HT_NOIDANGKY ndk on kh.noiDangKy = ndk.MaNoiDangKy   where (so=''  or  ngaydangky=''  or charindex('/',so,0)=0  or charindex('/',quyenSo,0)=0  or charindex('.',ngayDangKy,0)=0   or (CHARINDEX('T',trim(chongNgayCapGiayToTuyThan),0)=0 and trim(chongNgayCapGiayToTuyThan) not like '[0-9][0-9]' and trim(chongNgayCapGiayToTuyThan) not like '[0-9][0-9][0-9][0-9]' and trim(chongNgayCapGiayToTuyThan) not like '[0-9][0-9].[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(chongNgayCapGiayToTuyThan) not like '[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(chongNgayCapGiayToTuyThan) is not null and trim(chongNgayCapGiayToTuyThan) != '') or (CHARINDEX('T',trim(chongNgaySinh),0)=0 and trim(chongNgaySinh) not like '[0-9][0-9]' and trim(chongNgaySinh) not like '[0-9][0-9][0-9][0-9]' and trim(chongNgaySinh) not like '[0-9][0-9].[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(chongNgaySinh) not like '[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(chongNgaySinh) is not null and trim(chongNgaySinh) != '') or (CHARINDEX('T',trim(voNgayCapGiayToTuyThan),0)=0 and trim(voNgayCapGiayToTuyThan) not like '[0-9][0-9]' and trim(voNgayCapGiayToTuyThan) not like '[0-9][0-9][0-9][0-9]' and trim(voNgayCapGiayToTuyThan) not like '[0-9][0-9].[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(voNgayCapGiayToTuyThan) not like '[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(voNgayCapGiayToTuyThan) is not null and trim(voNgayCapGiayToTuyThan) != '') or (CHARINDEX('T',trim(voNgaySinh),0)=0 and trim(voNgaySinh) not like '[0-9][0-9]' and trim(voNgaySinh) not like '[0-9][0-9][0-9][0-9]' and trim(voNgaySinh) not like '[0-9][0-9].[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(voNgaySinh) not like '[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(voNgaySinh) is not null and trim(voNgaySinh) != '') ) 
cmcfmt = select so,quyenSo,trangSo,ngayDangKy, TenNoiDangKy,ncHoTen,cmNgayCapGiayToTuyThan,  cmNgaySinh, ncNgayCapGiayToTuyThan, ncNgaySinh, nycNgayCapGiayToTuyThan  from HT_NHANCHAMECON cmc join HT_NOIDANGKY ndk on cmc.noiDangKy = ndk.MaNoiDangKy  where (so=''  or  ngaydangky=''  or charindex('/',so,0)=0  or  charindex('/',quyenSo,0)=0  or charindex('.',ngayDangKy,0)=0   or (CHARINDEX('T',trim(cmNgaySinh),0)=0 and trim(cmNgaySinh) not like '[0-9][0-9]' and trim(cmNgaySinh) not like '[0-9][0-9][0-9][0-9]' and trim(cmNgaySinh) not like '[0-9][0-9].[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(cmNgaySinh) not like '[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(cmNgaySinh) is not null and trim(cmNgaySinh) != '') or (CHARINDEX('T',trim(ncNgayCapGiayToTuyThan),0)=0 and trim(ncNgayCapGiayToTuyThan) not like '[0-9][0-9]' and trim(ncNgayCapGiayToTuyThan) not like '[0-9][0-9][0-9][0-9]' and trim(ncNgayCapGiayToTuyThan) not like '[0-9][0-9].[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(ncNgayCapGiayToTuyThan) not like '[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(ncNgayCapGiayToTuyThan) is not null and trim(ncNgayCapGiayToTuyThan) != '') or (CHARINDEX('T',trim(ncNgaySinh),0)=0 and trim(ncNgaySinh) not like '[0-9][0-9]' and trim(ncNgaySinh) not like '[0-9][0-9][0-9][0-9]' and trim(ncNgaySinh) not like '[0-9][0-9].[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(ncNgaySinh) not like '[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(ncNgaySinh) is not null and trim(ncNgaySinh) != '') or (CHARINDEX('T',trim(nycNgayCapGiayToTuyThan),0)=0 and trim(nycNgayCapGiayToTuyThan) not like '[0-9][0-9]' and trim(nycNgayCapGiayToTuyThan) not like '[0-9][0-9][0-9][0-9]' and trim(nycNgayCapGiayToTuyThan) not like '[0-9][0-9].[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(nycNgayCapGiayToTuyThan) not like '[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(nycNgayCapGiayToTuyThan) is not null and trim(nycNgayCapGiayToTuyThan) != '') ) 
hnfmt = select so,quyenSo,trangSo,ngayDangKy, TenNoiDangKy, nxnHoTen,nxnNgayCapGiayToTuyThan,nxnNgaySinh,  nycNgayCapGiayToKhac  from HT_XACNHANHONNHAN cmc join HT_NOIDANGKY ndk on cmc.noiCap = ndk.MaNoiDangKy  where (so=''  or  ngaydangky=''  or charindex('/',so,0)=0  or charindex('/',quyenSo,0)=0  or charindex('.',ngayDangKy,0)=0   or (CHARINDEX('T',trim(nxnNgayCapGiayToTuyThan),0)=0 and trim(nxnNgayCapGiayToTuyThan) not like '[0-9][0-9]' and trim(nxnNgayCapGiayToTuyThan) not like '[0-9][0-9][0-9][0-9]' and trim(nxnNgayCapGiayToTuyThan) not like '[0-9][0-9].[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(nxnNgayCapGiayToTuyThan) not like '[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(nxnNgayCapGiayToTuyThan) is not null and trim(nxnNgayCapGiayToTuyThan) != '') or (CHARINDEX('T',trim(nxnNgaySinh),0)=0 and trim(nxnNgaySinh) not like '[0-9][0-9]' and trim(nxnNgaySinh) not like '[0-9][0-9][0-9][0-9]' and trim(nxnNgaySinh) not like '[0-9][0-9].[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(nxnNgaySinh) not like '[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(nxnNgaySinh) is not null and trim(nxnNgaySinh) != '') or (CHARINDEX('T',trim(nycNgayCapGiayToKhac),0)=0 and trim(nycNgayCapGiayToKhac) not like '[0-9][0-9]' and trim(nycNgayCapGiayToKhac) not like '[0-9][0-9][0-9][0-9]' and trim(nycNgayCapGiayToKhac) not like '[0-9][0-9].[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(nycNgayCapGiayToKhac) not like '[0-9][0-9].[0-9][0-9][0-9][0-9]' and trim(nycNgayCapGiayToKhac) is not null and trim(nycNgayCapGiayToKhac) != '') )  
sql_import = declare @ngay date set @ngay = GETDATE()  select quyenSo 'Quyển số', TenNoiDangKy 'Nơi đăng ký', count(*) N'Số lượng', TableName as N'Loại' from HT_KHAISINH ks join HT_NOIDANGKY ndk on ks.noiDangKy = ndk.MaNoiDangKy join HT_XULY xl on ks.ID = xl.ObjectID where ks.TinhTrangID = 1 and TableName = 'HT_KHAISINH' and CAST(NgayXuLy as date) = @ngay and NguoiXuLyID is Null group by quyenSo, TenNoiDangKy, TableName union all select quyenSo 'Quyển số', TenNoiDangKy 'Nơi đăng ký', count(*) N'Số lượng', TableName as N'Loại' from HT_KHAITU ks join HT_NOIDANGKY ndk on ks.noiDangKy = ndk.MaNoiDangKy join HT_XULY xl on ks.ID = xl.ObjectID where ks.TinhTrangID = 1 and TableName = 'HT_KHAITU' and CAST(NgayXuLy as date) = @ngay and NguoiXuLyID is Null group by quyenSo, TenNoiDangKy, TableName union all select quyenSo 'Quyển số', TenNoiDangKy 'Nơi đăng ký', count(*) N'Số lượng', TableName as N'Loại' from HT_KETHON ks join HT_NOIDANGKY ndk on ks.noiDangKy = ndk.MaNoiDangKy join HT_XULY xl on ks.ID = xl.ObjectID where ks.TinhTrangID = 1 and TableName = 'HT_KETHON' and CAST(NgayXuLy as date) = @ngay and NguoiXuLyID is Null group by quyenSo, TenNoiDangKy, TableName union all select quyenSo 'Quyển số', TenNoiDangKy 'Nơi đăng ký', count(*) N'Số lượng', TableName as N'Loại' from HT_NHANCHAMECON ks join HT_NOIDANGKY ndk on ks.noiDangKy = ndk.MaNoiDangKy join HT_XULY xl on ks.ID = xl.ObjectID where ks.TinhTrangID = 1 and TableName = 'HT_NHANCHAMECON' and CAST(NgayXuLy as date) = @ngay and NguoiXuLyID is Null group by quyenSo, TenNoiDangKy, TableName union all select quyenSo 'Quyển số', TenNoiDangKy 'Nơi đăng ký', count(*) N'Số lượng', TableName as N'Loại' from HT_XACNHANHONNHAN ks join HT_NOIDANGKY ndk on ks.noiCap = ndk.MaNoiDangKy join HT_XULY xl on ks.ID = xl.ObjectID where ks.TinhTrangID = 1 and TableName = 'HT_XACNHANHONNHAN' and CAST(NgayXuLy as date) = @ngay and NguoiXuLyID is Null group by quyenSo, TenNoiDangKy, TableName order by TableName 
sql_details_by_status = select 'KS', MaNoiDangKy, TenNoiDangKy, quyenSo, Ten , count(*) as 'SL' from HT_KHAISINH ks join HT_NOIDANGKY ndk on ks.noiDangKy = ndk.MaNoiDangKy join DC_DMTINHTRANG tt on ks.TinhTrangID = tt.TinhTrangID group by MaNoiDangKy, TenNoiDangKy, quyenSo, Ten union all select 'KT' as 'Loại', MaNoiDangKy as 'Mã nơi đăng ký', TenNoiDangKy 'Tên nơi đăng ký', quyenSo as 'Quyển số', Ten , count(*) as 'Số lượng' from HT_KHAITU ks join HT_NOIDANGKY ndk on ks.noiDangKy = ndk.MaNoiDangKy join DC_DMTINHTRANG tt on ks.TinhTrangID = tt.TinhTrangID group by MaNoiDangKy, TenNoiDangKy, quyenSo, Ten union all select 'KH' as 'Loại', MaNoiDangKy as 'Mã nơi đăng ký', TenNoiDangKy 'Tên nơi đăng ký', quyenSo as 'Quyển số', Ten , count(*) as 'Số lượng' from HT_KETHON ks join HT_NOIDANGKY ndk on ks.noiDangKy = ndk.MaNoiDangKy join DC_DMTINHTRANG tt on ks.TinhTrangID = tt.TinhTrangID group by MaNoiDangKy, TenNoiDangKy, quyenSo, Ten union all select 'CMC' as 'Loại', MaNoiDangKy as 'Mã nơi đăng ký', TenNoiDangKy 'Tên nơi đăng ký', quyenSo as 'Quyển số', Ten , count(*) as 'Số lượng' from HT_NHANCHAMECON ks join HT_NOIDANGKY ndk on ks.noiDangKy = ndk.MaNoiDangKy join DC_DMTINHTRANG tt on ks.TinhTrangID = tt.TinhTrangID group by MaNoiDangKy, TenNoiDangKy, quyenSo, Ten union all select 'XNHN' as 'Loại', MaNoiDangKy as 'Mã nơi đăng ký', TenNoiDangKy 'Tên nơi đăng ký', quyenSo as 'Quyển số', Ten , count(*) as 'Số lượng' from HT_XACNHANHONNHAN ks join HT_NOIDANGKY ndk on ks.noiCap = ndk.MaNoiDangKy join DC_DMTINHTRANG tt on ks.TinhTrangID = tt.TinhTrangID group by MaNoiDangKy, TenNoiDangKy, quyenSo , Ten order by MaNoiDangKy, TenNoiDangKy, Ten 
sql_details_by_book = select 'KS' as N'Loại', MaNoiDangKy as N'Mã nơi đăng ký', TenNoiDangKy as N'Tên nơi đăng ký', quyenSo as N'Quyển số' , count(*) as N'Số lượng' from HT_KHAISINH ks join HT_NOIDANGKY ndk on ks.noiDangKy = ndk.MaNoiDangKy group by MaNoiDangKy, TenNoiDangKy, quyenSo union all select 'KT' as 'Loại', MaNoiDangKy as 'Mã nơi đăng ký', TenNoiDangKy 'Tên nơi đăng ký', quyenSo as 'Quyển số' , count(*) as 'Số lượng' from HT_KHAITU ks join HT_NOIDANGKY ndk on ks.noiDangKy = ndk.MaNoiDangKy group by MaNoiDangKy, TenNoiDangKy, quyenSo union all select 'KH' as 'Loại', MaNoiDangKy as 'Mã nơi đăng ký', TenNoiDangKy 'Tên nơi đăng ký', quyenSo as 'Quyển số' , count(*) as 'Số lượng' from HT_KETHON ks join HT_NOIDANGKY ndk on ks.noiDangKy = ndk.MaNoiDangKy group by MaNoiDangKy, TenNoiDangKy, quyenSo union all select 'CMC' as 'Loại', MaNoiDangKy as 'Mã nơi đăng ký', TenNoiDangKy 'Tên nơi đăng ký', quyenSo as 'Quyển số' , count(*) as 'Số lượng' from HT_NHANCHAMECON ks join HT_NOIDANGKY ndk on ks.noiDangKy = ndk.MaNoiDangKy group by MaNoiDangKy, TenNoiDangKy, quyenSo union all select 'XNHN' as 'Loại', MaNoiDangKy as 'Mã nơi đăng ký', TenNoiDangKy 'Tên nơi đăng ký', quyenSo as 'Quyển số' , count(*) as 'Số lượng' from HT_XACNHANHONNHAN ks join HT_NOIDANGKY ndk on ks.noiCap = ndk.MaNoiDangKy group by MaNoiDangKy, TenNoiDangKy, quyenSo order by MaNoiDangKy, TenNoiDangKy,  N'Loại', quyenSo 
sql_details_by_year = select 'KS' as N'Loại', MaNoiDangKy as N'Mã nơi đăng ký', TenNoiDangKy as N'Tên nơi đăng ký', Right(quyenSo, 4) as N'Quyển số' , count(*) as N'Số lượng' from HT_KHAISINH ks join HT_NOIDANGKY ndk on ks.noiDangKy = ndk.MaNoiDangKy group by MaNoiDangKy, TenNoiDangKy, Right(quyenSo, 4) union all select 'KT' as 'Loại', MaNoiDangKy as 'Mã nơi đăng ký', TenNoiDangKy 'Tên nơi đăng ký', Right(quyenSo, 4) as 'Quyển số' , count(*) as 'Số lượng' from HT_KHAITU ks join HT_NOIDANGKY ndk on ks.noiDangKy = ndk.MaNoiDangKy group by MaNoiDangKy, TenNoiDangKy, Right(quyenSo, 4) union all select 'KH' as 'Loại', MaNoiDangKy as 'Mã nơi đăng ký', TenNoiDangKy 'Tên nơi đăng ký', Right(quyenSo, 4) as 'Quyển số' , count(*) as 'Số lượng' from HT_KETHON ks join HT_NOIDANGKY ndk on ks.noiDangKy = ndk.MaNoiDangKy group by MaNoiDangKy, TenNoiDangKy, Right(quyenSo, 4) union all select 'CMC' as 'Loại', MaNoiDangKy as 'Mã nơi đăng ký', TenNoiDangKy 'Tên nơi đăng ký', Right(quyenSo, 4) as 'Quyển số' , count(*) as 'Số lượng' from HT_NHANCHAMECON ks join HT_NOIDANGKY ndk on ks.noiDangKy = ndk.MaNoiDangKy group by MaNoiDangKy, TenNoiDangKy, Right(quyenSo, 4) union all select 'XNHN' as 'Loại', MaNoiDangKy as 'Mã nơi đăng ký', TenNoiDangKy 'Tên nơi đăng ký', Right(quyenSo, 4) as 'Quyển số' , count(*) as 'Số lượng' from HT_XACNHANHONNHAN ks join HT_NOIDANGKY ndk on ks.noiCap = ndk.MaNoiDangKy group by MaNoiDangKy, TenNoiDangKy, Right(quyenSo, 4) order by MaNoiDangKy, TenNoiDangKy,  N'Loại', Right(quyenSo, 4) 


[tpkontum]
db = HoTichDataTPKonTum
mcc = 608
import = \\192.168.1.25\PULL\Kontum\TP Kontum
tmp = \\192.168.1.25\PUSH\PULL\Kontum\TP Kontum
files = \\192.168.1.98\d\Phan mem trien khai\2023_HOTICH\KTM_THANHPHO2\Files
nen = \\192.168.1.98\d\Phan mem trien khai\2023_HOTICH\KTM_THANHPHO2\FilesNen\Phan mem trien khai\2023_HOTICH\KTM_THANHPHO2\Files
exe = \\192.168.1.25\SFTP\Xuat du lieu\02. PM import\TranFileTPKontum\TranFile.exe

; [sathay]
; db = HoTichDataKTMSaThay
; mcc = 616
; import = \\192.168.1.25\PULL\Kontum\Sa Thay
; tmp = \\192.168.1.25\PUSH\PULL\Kontum\Sa Thay
; files = \\192.168.1.98\e\FILE_DU_AN\2023_HOTICH\KTM_SATHAY\Files
; nen = \\192.168.1.98\e\FILE_DU_AN\2023_HOTICH\KTM_SATHAY\FilesNen\FILE_DU_AN\2023_HOTICH\KTM_SATHAY\Files
; exe = \\192.168.1.25\SFTP\Xuat du lieu\02. PM import\TranFileSaThay\TranFile.exe

; [dakto]
; db = HoTichDataKTMDakTo
; mcc = 82
; import = \\192.168.1.25\PULL\Kontum\Dak To
; tmp = \\192.168.1.25\PUSH\PULL\Kontum\Dak To
; files = \\192.168.1.98\e\FILE_DU_AN\2023_HOTICH\KTM_DAKTO\Files
; nen = \\192.168.1.98\e\FILE_DU_AN\2023_HOTICH\KTM_DAKTO\FilesNen\FILE_DU_AN\2023_HOTICH\KTM_DAKTO\Files
; exe = \\192.168.1.25\SFTP\Xuat du lieu\02. PM import\TranFileDakTo\TranFile.exe

[ngochoi]
db = HoTichDataKTMNgocHoi
mcc = 611
import = \\192.168.1.25\PULL\Kontum\Ngoc Hoi
tmp = \\192.168.1.25\PUSH\PULL\Kontum\Ngoc Hoi
files = \\192.168.1.98\e\FILE_DU_AN\2023_HOTICH\KTM_NGOCHOI\Files
nen = \\192.168.1.98\e\FILE_DU_AN\2023_HOTICH\KTM_NGOCHOI\Filesnen\FILE_DU_AN\2023_HOTICH\KTM_NGOCHOI\Files
exe = \\192.168.1.25\SFTP\Xuat du lieu\02. PM import\TranFileNgocHoi\TranFile.exe

[konray]
db = HoTichDataKTMKonRay2023
mcc = 614
import = \\192.168.1.25\PULL\Kontum\Kon Ray
tmp = \\192.168.1.25\PUSH\PULL\Kontum\Kon Ray
files = \\192.168.1.98\e\FILE_DU_AN\2023_HOTICH\KTM_KONRAY\Files
nen = \\192.168.1.98\e\FILE_DU_AN\2023_HOTICH\KTM_KONRAY\FilesNen\FILE_DU_AN\2023_HOTICH\KTM_KONRAY\Files
exe = \\192.168.1.25\SFTP\Xuat du lieu\02. PM import\TranFileKonRay\TranFile.exe

[konplong]
db = HoTichDataKTMKonPlong2023
mcc = 613
import = \\192.168.1.25\PULL\Kontum\Kon Plong
tmp = \\192.168.1.25\PUSH\PULL\Kontum\Kon Plong
files = \\192.168.1.98\e\FILE_DU_AN\2023_HOTICH\KTM_KONPLONG\Files
nen = \\192.168.1.98\e\FILE_DU_AN\2023_HOTICH\KTM_KONPLONG\FilesNen\FILE_DU_AN\2023_HOTICH\KTM_KONPLONG\Files
exe = \\192.168.1.25\SFTP\Xuat du lieu\02. PM import\TranFileKonPLong\TranFile.exe

[dakglong]
db = HoTichDataDakNongDakGlong2023
mcc = 61
import = \\192.168.1.25\PULL\Dak Nong\Dak Glong
tmp = \\192.168.1.25\PUSH\PULL\Dak Nong\Dak Glong
files = \\192.168.1.98\e\FILE_DU_AN\2023_HOTICH\DNO_DAKGLONG\Files
nen = \\192.168.1.98\e\FILE_DU_AN\2023_HOTICH\DNO_DAKGLONG\Filesnen\FILE_DU_AN\2023_HOTICH\DNO_DAKGLONG\Files
exe = \\192.168.1.25\SFTP\Xuat du lieu\02. PM import\TranFileDakGlong\TranFile.exe

[krongno]
db = HoTichDataDakNongKrongnoOS2023
mcc = 66
import =  \\192.168.1.25\PULL\Dak Nong\Krong No
tmp = \\192.168.1.25\PUSH\PULL\Dak Nong\Krong No
files = \\192.168.1.98\e\FILE_DU_AN\2023_HOTICH\DNO_KRONGNO\Files
nen = \\192.168.1.98\e\FILE_DU_AN\2023_HOTICH\DNO_KRONGNO\Filesnen\FILE_DU_AN\2023_HOTICH\DNO_KRONGNO\Files
exe = \\192.168.1.25\SFTP\Xuat du lieu\02. PM import\TranFileKrongNo\TranFile.exe

[tuyduc]
db = HoTichDataDakNongTuyDuc2023
mcc = 67
import = \\192.168.1.25\PULL\Dak Nong\Tuy Duc
tmp = \\192.168.1.25\PUSH\PULL\Dak Nong\Tuy Duc
files = \\192.168.1.98\e\FILE_DU_AN\2023_HOTICH\DNO_TUYDUC\Files
nen = \\192.168.1.98\e\FILE_DU_AN\2023_HOTICH\DNO_TUYDUC\Filesnen\FILE_DU_AN\2023_HOTICH\DNO_TUYDUC\Files
exe = \\192.168.1.25\SFTP\Xuat du lieu\02. PM import\TranFileTuyDuc\TranFile.exe

[quangninh]
db = HoTichDataQuangBinh
mcc = 45
import = \\192.168.1.25\PULL\Quang Binh\Quang Ninh
tmp = \\192.168.1.25\PUSH\PULL\Quang Binh\Quang Ninh
files = \\192.168.1.98\e\FILE_DU_AN\2023_HOTICH\QBN_QUANGBINH\Files
nen = \\192.168.1.98\e\FILE_DU_AN\2023_HOTICH\QBN_QUANGBINH\Filesnen\FILE_DU_AN\2023_HOTICH\QBN_QUANGBINH\Files
exe = \\192.168.1.25\SFTP\Xuat du lieu\02. PM import\TranFileQuangNinh\TranFile.exe

[badon]
db = HoTichDataQuangBinhBaDon
mcc = 458
import = \\192.168.1.25\PULL\Quang Binh\Ba Don
tmp = \\192.168.1.25\PUSH\PULL\Quang Binh\Ba Don
files = \\192.168.1.98\e\FILE_DU_AN\2023_HOTICH\QBN_BADON\Files
nen = \\192.168.1.98\e\FILE_DU_AN\2023_HOTICH\QBN_BADON\FilesNen\FILE_DU_AN\2023_HOTICH\QBN_BADON\Files
exe = \\192.168.1.25\SFTP\Xuat du lieu\02. PM import\TranFileBaDon\TranFile.exe

[lethuy]
db = HoTichDataQuangBinhLeThuy
mcc = 457
import = \\192.168.1.25\PULL\Quang Binh\Le Thuy
tmp = \\192.168.1.25\PUSH\PULL\Quang Binh\Le Thuy
files = \\192.168.1.98\e\FILE_DU_AN\2023_HOTICH\QBN_LETHUY\Files
nen = \\192.168.1.98\e\FILE_DU_AN\2023_HOTICH\QBN_LETHUY\FilesNen\FILE_DU_AN\2023_HOTICH\QBN_LETHUY\Files
exe = \\192.168.1.25\SFTP\Xuat du lieu\02. PM import\TranFileLeThuy\TranFile.exe
